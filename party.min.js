const party=function(){function t(){return Math.random()}function e(e,i){return n(e,i,t())}function n(t,e,n){return(1-n)*t+n*e}function i(t,n){return t*e(1-n/2,1+n/2)}function r(t,n){return t+e(-n/2,n/2)}function o(t,e,n){let i,r,o;if(t/=360,e/=100,n/=100,0===e)i=r=o=n;else{const s=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t),a=n<.5?n*(1+e):n+e-n*e,h=2*n-a;i=s(h,a,t+1/3),r=s(h,a,t),o=s(h,a,t-1/3)}const s=t=>{const e=Math.round(255*t).toString(16);return 1===e.length?"0"+e:e};return`#${s(i)}${s(r)}${s(o)}`}function s(t,e,i){function r(t){return t.toString(16)}function o(t){return parseInt(t,16)}i=null!=i?i:.5;for(var s="#",a=1;a<=5;a+=2){for(var h=o(t.substr(a,2)),l=o(e.substr(a,2)),c=r(Math.floor(n(h,l,i)));c.length<2;)c="0"+c;s+=c}return s}function a(t){if(!(t instanceof v))throw new TypeError("Invalid transform supplied to lighting calculation.");return Math.abs(Math.cos(t.rotation.x)*Math.cos(t.rotation.y))}function h(t,e,n){return t&&null!=t[e]?t[e]:n}function l(t,e,n){t&&null==t[e]&&(t[e]=n)}function c(t,e){for(var n in e)e.hasOwnProperty(n)&&l(t,n,e[n])}function m(e,n,l){let c=i(h(l,"count",1),h(l,"countVariation",0)),m=h(l,"angleSpan",0),d=h(l,"rotationVelocityLimit",0),w=h(l,"scaleVariation",0);for(let u=0;u<c;u++){let c=r(0,m)*N,u=i(h(l,"yVelocity",0),h(l,"yVelocityVariation",0)),y=i(h(l,"size",8),w);f({shape:h(l,"shape","square"),acceleration:new v(new x(0,h(l,"gravity",!0)*p.gravityPixels),x.zero),velocity:new v(new x(Math.sin(c)*u,Math.cos(c)*u),x.generate(()=>d*t())),transform:new v(new x((e.left||0)+i((e.width||0)/2,2*h(l,"randomizePosition",!0))+(n?window.scrollX:0),(e.top||0)+i((e.height||0)/2,2*h(l,"randomizePosition",!0))+(n?window.scrollY:0)),x.generate(()=>Math.PI*h(l,"randomizeRotation",!0)*t()),x.one.scale(y)),color:h(l,"color",h(l,"colorFunction",()=>o(360*t(),100,70))()),lifetime:0,draw:function(t){t.fillStyle=p.applyLighting?s("#000000",this.color,.25+.75*a(this.transform)):this.color;const e=.2;let n=this.lifetime>e?1:this.lifetime/e,i=B[this.shape];if(!i)throw Error(`Unknown shape '${this.shape}'.`);let r=new v(this.transform.position,this.transform.rotation,this.transform.scale.scale(n));i.withTransform(r).draw(t)},update:function(t){this.velocity=this.velocity.applyDelta(this.acceleration,t),this.transform=this.transform.applyDelta(this.velocity,t),this.lifetime+=t}})}}function f(t){for(;F.length>=p.maxParticles;)F.shift();F.push(t)}function d(t){F.forEach(e=>e.update(t));let e=Math.max(document.documentElement.offsetHeight,window.innerHeight);F=F.filter(t=>t.transform.position.y<=e)}function w(){k.canvas.width=window.innerWidth,k.canvas.height=window.innerHeight,k.clearRect(0,0,k.canvas.width,k.canvas.height),F.forEach(t=>t.draw(k))}function u(t){let e=(t-P)/1e3;F.length>0&&(d(e),w()),P=t,window.requestAnimationFrame(u)}const p={maxParticles:1e3,gravityPixels:800,applyLighting:!0},y={typeCheckFailed:"Invalid '{0}' supplied to method.",abstractMethodNotImplemented:"The type is required to implement the '{0}' method.",invalidPathNode:"Invalid node '{0}' detected in SVG path.",malformedPathNode:"Malformed node '{0}' detected in SVG path."};class g{constructor(t){this.index=0,this.items=t}first(){return this.reset(),this.next()}next(){return this.items[this.index++]}hasNext(){return this.index<this.items.length}reset(){this.index=0}each(t){for(let e=this.first();this.hasNext();e=this.next())t(e)}}class x{constructor(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}add(t){if(!(t instanceof x))throw new TypeError(y.typeCheckFailed.format("Vector"));return new x(this.x+t.x,this.y+t.y,this.z+t.z)}scale(t){if("number"==typeof t)return new x(this.x*t,this.y*t,this.z*t);if(t instanceof x)return new x(this.x*t.x,this.y*t.y,this.z*t.z);throw new TypeError(y.typeCheckFailed.format("Number/Vector"))}static get zero(){return new x}static get one(){return new x(1,1,1)}static generate(t){if("function"!=typeof t)throw new TypeError(y.typeCheckFailed.format("Function"));return new x(t(),t(),t())}}class v{constructor(t,e,n){this.position=t||x.zero,this.rotation=e||x.zero,this.scale=n||x.zero}applyDelta(t,e){if(!(t instanceof v))throw new TypeError(y.typeCheckFailed.format("Transform"));if("number"!=typeof e)throw new TypeError(y.typeCheckFailed.format("Number"));return new v(this.position.add(t.position.scale(e)),this.rotation.add(t.rotation.scale(e)),this.scale.add(t.scale.scale(e)))}apply(t){if(!(t instanceof x))throw new TypeError(y.typeCheckFailed.format("Vector"));let e=t.x*this.scale.x,n=t.y*this.scale.y;return new x(this.position.x+(e*Math.cos(this.rotation.z)-n*Math.sin(this.rotation.z))*Math.cos(this.rotation.y),this.position.y+(e*Math.sin(this.rotation.z)+n*Math.cos(this.rotation.z))*Math.cos(this.rotation.x))}}class V{constructor(t,e,n,i){this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=i}static fromVertices(t){let e=new V(1/0,1/0,0,0);for(let n=0;n<t.length;n++){let i=t[n];e.xmin=Math.min(i.x,e.xmin),e.ymin=Math.min(i.y,e.ymin),e.xmax=Math.max(i.x,e.xmax),e.ymax=Math.max(i.y,e.ymax)}return e}}class C{constructor(t,e,n,i,r){this.xmin=t,this.ymin=e,this.width=r?n:Math.max(n,i),this.height=r?i:Math.max(n,i)}transformX(t){return(t-this.xmin-this.width/2)/this.width}transformY(t){return(t-this.ymin-this.height/2)/this.height}transformPoint(t){return new x(this.transformX(t.x),this.transformY(t.y))}static fromBounds(t){return new C(t.xmin,t.ymin,t.xmax-t.xmin,t.ymax-t.ymin)}}class b{withTransform(t){if(!(t instanceof v))throw new TypeError(y.typeCheckFailed.format("Transform"));return this.transform=t,this}getBounds(){throw new Error(y.abstractMethodNotImplemented.format("getBounds()"))}normalize(t){throw new Error(y.abstractMethodNotImplemented.format("normalize(viewBox)"))}draw(t){throw new Error(y.abstractMethodNotImplemented.format("draw(context)"))}}class z extends b{constructor(t){if(super(),!Array.isArray(t))throw new TypeError(y.typeCheckFailed.format("Array"));this.points=t}getBounds(){return V.fromVertices(this.points)}normalize(t){if(t=t||C.fromBounds(this.getBounds()),!(t instanceof C))throw new TypeError(y.typeCheckFailed.format("ViewBox"));this.points=this.points.map(e=>t.transformPoint(e))}draw(t){if(!(t instanceof CanvasRenderingContext2D))throw new TypeError(y.typeCheckFailed.format("CanvasRenderingContext2D"));t.beginPath();for(let e=0;e<this.points.length;e++){let n=this.transform?this.transform.apply(this.points[e]):this.points[e];(0==e?t.moveTo:t.lineTo).apply(t,[n.x-window.scrollX,n.y-window.scrollY])}t.closePath(),t.fill()}}class E extends b{constructor(t){super(),this.nodes=[];let e=new x,n=new g(t);for(;n.hasNext();){let i=n.next();"string"!=typeof i&&(i=t.slice(0,n.index).reverse().find(t=>"string"==typeof t),"m"==i.toLowerCase()&&(i=i.toLowerCase()==i?"l":"L"),n.index--);let r,o,s=i.toLowerCase()==i,a=s?new x(e.x,e.y):new x;switch(i.toLowerCase()){case"m":r="move",o=[a.x+n.next(),a.y+n.next()],e.x=o[0],e.y=o[1];break;case"l":r="line",o=[a.x+n.next(),a.y+n.next()],e.x=o[0],e.y=o[1];break;case"h":r="line",o=[a.x+n.next(),e.y],e.x=o[0];break;case"v":r="line",o=[e.x,a.y+n.next()],e.y=o[1];break;case"z":r="line";let t=this.nodes.find(t=>"move"==t.type).getResultingCursor();o=[t.x,t.y],e.x=t.x,e.y=t.y;break;case"c":r="bezier",o=[];for(let t=0;t<3;t++)o.push(a.x+n.next()),o.push(a.y+n.next());e.x=o[o.length-2],e.y=o[o.length-1];break;case"s":r="bezier";let s=this.nodes[this.nodes.length-1];if("bezier"!=s.type)throw new Error(y.malformedPathNode.format(i));let h=e.x+(s.args[4]-s.args[2]),l=e.y+(s.args[5]-s.args[3]);o=[h,l];for(let t=0;t<2;t++)o.push(a.x+n.next()),o.push(a.y+n.next());e.x=o[o.length-2],e.y=o[o.length-1]}this.nodes.push(new M(r,o))}this.nodes.length>50&&console.warn("Complex shape registered, high usage may impact framerate.")}getBounds(){return V.fromVertices(this.nodes.map(t=>t.getResultingCursor()))}normalize(t){if(t=t||C.fromBounds(this.getBounds()),!(t instanceof C))throw new TypeError(y.typeCheckFailed.format("ViewBox"));let e=new g(this.nodes);for(;e.hasNext();){let n=e.next();for(let e=0;e<n.args.length;e+=2)n.args[e]=t.transformX(n.args[e]),n.args[e+1]=t.transformY(n.args[e+1])}}draw(t){if(!(t instanceof CanvasRenderingContext2D))throw new TypeError(y.typeCheckFailed.format("CanvasRenderingContext2D"));t.beginPath(),new g(this.nodes).each(e=>e.run(t,this.transform)),t.fill()}}class M{constructor(t,e){this.type=t,this.args=e}getResultingCursor(){return new x(this.args[this.args.length-2],this.args[this.args.length-1])}run(t,e){let n;switch(this.type){case"move":n=t.moveTo;break;case"line":n=t.lineTo;break;case"bezier":n=t.bezierCurveTo}let i=[];for(let t=0;t<this.args.length;t+=2){let n=new x(this.args[t],this.args[t+1]);e&&(n=e.apply(n)),i.push(n.x-window.scrollX),i.push(n.y-window.scrollY)}n.apply(t,i)}}const T=document.createElement("canvas");T.id="party-js-canvas",T.style="position: fixed; left: 0; top: 0; pointer-events: none;";const k=T.getContext("2d");document.body?document.body.appendChild(T):window.addEventListener("load",()=>document.body.appendChild(T));var F=[];const B={square:new z([new x(-.5,.5),new x(.5,.5),new x(.5,-.5),new x(-.5,-.5)]),rectangle:new z([new x(-.3,1),new x(.3,1),new x(.3,-1),new x(-.3,-1)])},N=(Math.PI,Math.PI/180);String.prototype.format=function(){var t=this;for(var e in arguments)t=t.replace(new RegExp("\\{"+e+"\\}","g"),arguments[e]);return t};var P=0;return window.requestAnimationFrame(u),{element:function(t,e){e=e||{},c(e,{count:40,countVariation:.5,angleSpan:80,yVelocity:-300,yVelocityVariation:1,rotationVelocityLimit:6,scaleVariation:.8}),m(t.getBoundingClientRect(),!0,e)},position:function(t,e,n){n=n||{},c(n,{count:40,countVariation:.5,angleSpan:80,yVelocity:-300,yVelocityVariation:1,rotationVelocityLimit:6,scaleVariation:.8});let i={left:t,top:e};m(i,!0,n)},cursor:function(t){let e=window.event;if(null==e.clientX||null==e.clientY)return console.error("Calling 'party.cursor()' with no current mouse event is not allowed.");this.position(window.event.clientX,window.event.clientY,t)},screen:function(t){t=t||{},c(t,{count:window.innerWidth/1980*500,countVariation:.5,angleSpan:0,yVelocity:-100,yVelocityVariation:2,rotationVelocityLimit:6,scaleVariation:.8});let e={width:window.innerWidth,height:-window.innerHeight};m(e,!0,t)},registerShape:function(t,e){if(Array.isArray(e))B[t]=new z(e);else if("string"==typeof e){let i=new DOMParser,r=i.parseFromString(e,"application/xml"),o=r.getElementsByTagName("parsererror")[0];if(o)throw new Error("Invalid SVG shape.");var n;let s,a=r.getElementsByTagName("svg")[0];a&&a.hasAttribute("viewBox")&&(n=C.fromBounds(a.getAttribute("viewBox").split(" ").map(t=>parseFloat(t))));let h=r.getElementsByTagName("polygon")[0];if(!s&&h){let t=h.getAttribute("points"),e=/(-?\d*\.\d+|-?\d+)/g,n=t.match(e),i=[];for(let t=0;t<n.length;t+=2)i.push(new x(parseFloat(n[t]),parseFloat(n[t+1])));s=new z(i)}let l=r.getElementsByTagName("path")[0];if(!s&&l){let t=l.getAttribute("d"),e=/([A-Za-z]|-?\d*\.\d+|-?\d+)/g,n=t.match(e),i=[];for(let t=0;t<n.length;t++){let e=n[t],r=parseFloat(e);i.push(isNaN(r)?e:r)}s=new E(i)}if(!s)throw new Error("No shape was determined from the SVG.");s.normalize(n),B[t]=s}}}}();