const party=function(){function t(){return Math.random()}function n(n,o){return i(n,o,t())}function i(t,n,i){return(1-i)*t+i*n}function o(t,i){return t*n(1-i/2,1+i/2)}function e(t,i){return t+n(-i/2,i/2)}function r(t,n,i){let o,e,r;if(t/=360,n/=100,i/=100,0===n)o=e=r=i;else{const a=(t,n,i)=>(i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(n-t)*i:i<.5?n:i<2/3?t+(n-t)*(2/3-i)*6:t),l=i<.5?i*(1+n):i+n-i*n,s=2*i-l;o=a(s,l,t+1/3),e=a(s,l,t),r=a(s,l,t-1/3)}const a=t=>{const n=Math.round(255*t).toString(16);return 1===n.length?"0"+n:n};return`#${a(o)}${a(e)}${a(r)}`}function a(t,n,o){function e(t){return t.toString(16)}function r(t){return parseInt(t,16)}o=null!=o?o:.5;for(var a="#",l=1;l<=5;l+=2){for(var s=r(t.substr(l,2)),c=r(n.substr(l,2)),u=e(Math.floor(i(s,c,o)));u.length<2;)u="0"+u;a+=u}return a}function l(t){return Math.abs(Math.cos(t.rotation.x)*Math.cos(t.rotation.y))}function s(t,n,i){return t&&null!=t[n]?t[n]:i}function c(t,n,i){t&&null==t[n]&&(t[n]=i)}function u(t,n){for(var i in n)n.hasOwnProperty(i)&&c(t,i,n[i])}function h(n,i,c){let u=o(s(c,"count",1),s(c,"countVariation",0)),h=s(c,"angleSpan",0),d=s(c,"rotationVelocityLimit",0),p=s(c,"scaleVariation",0);for(let y=0;y<u;y++){let u=e(0,h)*P,y=o(s(c,"yVelocity",0),s(c,"yVelocityVariation",0)),x=o(s(c,"size",8),p);f({shape:s(c,"shape","square"),acceleration:g(w(0,s(c,"gravity",!0)*m.gravityPixels),w()),velocity:g(w(Math.sin(u)*y,Math.cos(u)*y),w.generate(()=>d*t())),transform:g(w((n.left||0)+o((n.width||0)/2,2*s(c,"randomizePosition",!0))+(i?window.scrollX:0),(n.top||0)+o((n.height||0)/2,2*s(c,"randomizePosition",!0))+(i?window.scrollY:0)),w.generate(()=>Math.PI*s(c,"randomizeRotation",!0)*t()),w.one.scale(x)),color:s(c,"color",s(c,"colorFunction",()=>r(360*t(),100,70))()),lifetime:0,draw:function(){V.fillStyle=m.applyLighting?a("#000000",this.color,.25+.75*l(this.transform)):this.color;const t=.2;let n=this.lifetime>t?1:this.lifetime/t;if(null==z[this.shape])throw Error(`Unknown shape '${this.shape}'.`);z[this.shape].applyTransform(g(0,0,w.one.scale(n))).applyTransform(this.transform).draw(V)},update:function(t){this.velocity=this.velocity.applyDelta(this.acceleration,t),this.transform=this.transform.applyDelta(this.velocity,t),this.lifetime+=t}})}}function f(t){for(;M.length>=m.maxParticles;)M.shift();M.push(t)}function d(t){M.forEach(n=>n.update(t));let n=Math.max(document.documentElement.offsetHeight,window.innerHeight);M=M.filter(t=>t.transform.position.y<=n)}function p(){V.canvas.width=window.innerWidth,V.canvas.height=window.innerHeight,V.clearRect(0,0,V.canvas.width,V.canvas.height),M.forEach(t=>t.draw())}function y(t){let n=(t-b)/1e3;M.length>0&&(d(n),p()),b=t,window.requestAnimationFrame(y)}const m={maxParticles:1e3,gravityPixels:800,applyLighting:!0},w=function(t,n,i){return{x:t||0,y:n||0,z:i||0,add:function(t){return null==t.x||null==t.y||null==t.z?console.error("Invalid vector supplied to add operation."):w(this.x+t.x,this.y+t.y,this.z+t.z)},scale:function(t){return"number"!=typeof t?console.error("Invalid scale supplied to scale operation."):w(this.x*t,this.y*t,this.z*t)}}};w.one=w(1,1,1),w.generate=function(t){return"function"!=typeof t?console.error("Invalid factory function for generated vector."):w(t(),t(),t())};const g=function(t,n,i){return{position:t||w(),rotation:n||w(),scale:i||w(),applyDelta:function(t,n){return"number"!=typeof n?console.error("Invalid delta supplied to transform."):g(this.position.add(t.position.scale(n)),this.rotation.add(t.rotation.scale(n)),this.scale.add(t.scale.scale(n)))}}},x=function(t){return Array.isArray(t)?{points:t,applyTransform:function(t){return new x(this.points.map(n=>{let i=n.x*t.scale.x,o=n.y*t.scale.y;return w(t.position.x+(i*Math.cos(t.rotation.z)-o*Math.sin(t.rotation.z))*Math.cos(t.rotation.y),t.position.y+(i*Math.sin(t.rotation.z)+o*Math.cos(t.rotation.z))*Math.cos(t.rotation.x))}))},draw:function(t){V.beginPath();for(let n=0;n<this.points.length;n++){let i=this.points[n].x-window.scrollX,o=this.points[n].y-window.scrollY;(0==n?t.moveTo:t.lineTo).apply(t,[i,o])}V.closePath(),V.fill()}}:console.error("Invalid points definition.")};x.quad=x([w(-.5,.5),w(.5,.5),w(.5,-.5),w(-.5,-.5)]);const v=document.createElement("canvas");v.id="party-js-canvas",v.style="position: fixed; left: 0; top: 0; pointer-events: none;";const V=v.getContext("2d");document.body?document.body.appendChild(v):window.addEventListener("load",()=>document.body.appendChild(v));var M=[],z={square:x.quad,rectangle:x.quad.applyTransform(g(w(),w(),w(.6,2,1)))};Math.PI;const P=Math.PI/180;var b=0;return window.requestAnimationFrame(y),{element:function(t,n){n=n||{},u(n,{count:40,countVariation:.5,angleSpan:80,yVelocity:-300,yVelocityVariation:1,rotationVelocityLimit:6,scaleVariation:.8}),h(t.getBoundingClientRect(),!0,n)},position:function(t,n,i){i=i||{},u(i,{count:40,countVariation:.5,angleSpan:80,yVelocity:-300,yVelocityVariation:1,rotationVelocityLimit:6,scaleVariation:.8});let o={left:t,top:n};h(o,!0,i)},cursor:function(t){let n=window.event;if(null==n.clientX||null==n.clientY)return console.error("Calling 'party.cursor()' with no current mouse event is not allowed.");this.position(window.event.clientX,window.event.clientY,t)},screen:function(t){t=t||{},u(t,{count:window.innerWidth/1980*500,countVariation:.5,angleSpan:0,yVelocity:-100,yVelocityVariation:2,rotationVelocityLimit:6,scaleVariation:.8});let n={width:window.innerWidth,height:-window.innerHeight};h(n,!0,t)},registerShape:function(t,n){if(Array.isArray(n))z[t]=x(n);else if("string"==typeof n){let o=new DOMParser,e=o.parseFromString(n,"application/xml"),r=e.getElementsByTagName("polygon")[0];if(null!=r){let n=r.getAttribute("points"),o=/(\d+(\.\d+)?)/g,e=n.match(o),a=[];for(let t=0;t<e.length;t+=2)a.push(w(parseFloat(e[t]),parseFloat(e[t+1])));function i(t,n,i){return t.reduce(function(t,o){return(i?t[n]<o[n]:t[n]>o[n])?t:o})}let l={xmin:i(a,"x",!0).x,xmax:i(a,"x",!1).x,ymin:i(a,"y",!0).y,ymax:i(a,"y",!1).y};l.width=l.xmax-l.xmin,l.height=l.ymax-l.ymin,a=a.map(t=>w((t.x-l.xmin-l.width/2)/l.width,(t.y-l.ymin-l.height/2)/l.height)),z[t]=x(a)}}}}}();